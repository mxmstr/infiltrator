[gd_scene load_steps=74 format=3 uid="uid://c8eu5jcrx47a5"]

[ext_resource type="PackedScene" uid="uid://6emy26bk6w7q" path="res://Scenes/Actors/Humans/Human.tscn" id="1"]
[ext_resource type="Script" path="res://Scripts/Prop.Vision.gd" id="2"]
[ext_resource type="Script" path="res://Scripts/Prop.Hearing.gd" id="3"]
[ext_resource type="Script" path="res://Scripts/AnimationTree.StateMachine.gd" id="4"]
[ext_resource type="AnimationNodeStateMachine" path="res://Scenes/Components/DefaultStateMachine.tres" id="5"]
[ext_resource type="Animation" uid="uid://cptybn6j7yrgf" path="res://Animations/DefaultAnim.tres" id="6"]
[ext_resource type="Script" path="res://Scripts/AIPlanner.Animation.gd" id="7"]
[ext_resource type="Script" path="res://Scripts/AnimationTree.Animation.gd" id="8"]
[ext_resource type="Script" path="res://Scripts/Prop.Action.gd" id="9"]
[ext_resource type="Script" path="res://Scripts/AIPlanner.gd" id="10"]
[ext_resource type="Script" path="res://Scripts/AIDriver.Animation.gd" id="11"]
[ext_resource type="Script" path="res://Scripts/AnimationTree.BlendTree.Transition.gd" id="12"]
[ext_resource type="Script" path="res://Scripts/AnimationTree.BlendTree.gd" id="13"]
[ext_resource type="Script" path="res://Scripts/AIDriver.gd" id="14"]

[sub_resource type="AnimationNodeStateMachine" id="2"]
states/Start/position = Vector2(304, 163)
states/StateMachine/node = ExtResource("5")
states/StateMachine/position = Vector2(617, 163)
graph_offset = Vector2(0, 64.1571)
script = ExtResource("4")
statemachine = ""
chain = false

[sub_resource type="AnimationNodeStateMachinePlayback" id="3"]

[sub_resource type="AnimationNodeStateMachinePlayback" id="4"]

[sub_resource type="AnimationLibrary" id="AnimationLibrary_qmjdn"]
_data = {
"DefaultAnim": ExtResource("6")
}

[sub_resource type="AnimationNodeAnimation" id="5"]
animation = &"DefaultAnim"
script = ExtResource("7")
chain = true
schema = ""

[sub_resource type="AnimationNodeAnimation" id="6"]
animation = &"DefaultAnim"
script = ExtResource("8")
chain = true
schema = ""

[sub_resource type="AnimationNodeStateMachineTransition" id="7"]

[sub_resource type="AnimationNodeStateMachineTransition" id="8"]

[sub_resource type="AnimationNodeStateMachine" id="10"]
states/Investigate/node = SubResource("5")
states/Investigate/position = Vector2(579, 290)
states/Noise/node = SubResource("6")
states/Noise/position = Vector2(579, 217)
states/Start/position = Vector2(325, 217)
transitions = ["Start", "Noise", SubResource("7"), "Noise", "Investigate", SubResource("8")]
graph_offset = Vector2(-81.2823, 149.856)
script = ExtResource("4")
statemachine = ""
chain = false

[sub_resource type="AnimationNodeStateMachinePlayback" id="11"]

[sub_resource type="AnimationLibrary" id="AnimationLibrary_6g7qn"]
_data = {
"DefaultAnim": ExtResource("6")
}

[sub_resource type="AnimationNodeStateMachine" id="12"]
states/Start/position = Vector2(604, 183)
graph_offset = Vector2(74.0885, -54.7503)
script = ExtResource("4")
statemachine = ""
chain = false

[sub_resource type="AnimationNodeStateMachinePlayback" id="13"]

[sub_resource type="Animation" id="14"]
length = 0.001

[sub_resource type="AnimationLibrary" id="AnimationLibrary_qauup"]
_data = {
"DefaultAnim": SubResource("14")
}

[sub_resource type="AnimationNodeAnimation" id="16"]
animation = &"DefaultAnim"
script = ExtResource("11")
drive_mode = 0
move_speed = 0.0
turn_speed = 0.0
chain = true
schema = ""

[sub_resource type="AnimationNodeStateMachineTransition" id="17"]

[sub_resource type="AnimationNodeStateMachine" id="19"]
states/Start/position = Vector2(344, 180)
states/Wait/node = SubResource("16")
states/Wait/position = Vector2(779, 180.215)
transitions = ["Start", "Wait", SubResource("17")]
graph_offset = Vector2(0, 75.2147)
script = ExtResource("4")
statemachine = ""
chain = false

[sub_resource type="AnimationNodeStateMachinePlayback" id="20"]

[sub_resource type="Animation" id="21"]
length = 0.001

[sub_resource type="AnimationLibrary" id="AnimationLibrary_ycdhx"]
_data = {
"DefaultAnim": SubResource("21")
}

[sub_resource type="AnimationNodeStateMachine" id="22"]
states/Face/node = SubResource("16")
states/Face/position = Vector2(779, 180.215)
states/Start/position = Vector2(344, 180)
transitions = ["Start", "Face", SubResource("17")]
graph_offset = Vector2(0, 75.2147)
script = ExtResource("4")
statemachine = ""
chain = false

[sub_resource type="AnimationNodeStateMachinePlayback" id="23"]

[sub_resource type="Animation" id="24"]
length = 0.001

[sub_resource type="AnimationLibrary" id="AnimationLibrary_nqidj"]
_data = {
"DefaultAnim": SubResource("24")
}

[sub_resource type="AnimationNodeStateMachine" id="25"]
states/Follow/node = SubResource("16")
states/Follow/position = Vector2(779, 180.215)
states/Start/position = Vector2(344, 180)
transitions = ["Start", "Follow", SubResource("17")]
graph_offset = Vector2(0, 75.2147)
script = ExtResource("4")
statemachine = ""
chain = false

[sub_resource type="AnimationNodeStateMachinePlayback" id="26"]

[sub_resource type="Animation" id="27"]
length = 0.001

[sub_resource type="AnimationLibrary" id="AnimationLibrary_xewwj"]
_data = {
"DefaultAnim": SubResource("27")
}

[sub_resource type="AnimationNodeAnimation" id="28"]
animation = &"DefaultAnim"
script = ExtResource("8")
chain = false
schema = ""

[sub_resource type="AnimationNodeTransition" id="29"]
input_0/name = "Walk"
input_0/auto_advance = false
input_0/reset = true
input_1/name = "Stop"
input_1/auto_advance = false
input_1/reset = true
script = ExtResource("12")

[sub_resource type="AnimationNodeAnimation" id="30"]
animation = &"DefaultAnim"
script = ExtResource("8")
chain = false
schema = ""

[sub_resource type="AnimationNodeBlendTree" id="31"]
graph_offset = Vector2(-28.3349, 35.5164)
nodes/Stop/node = SubResource("28")
nodes/Stop/position = Vector2(200, 200)
nodes/Transition/node = SubResource("29")
nodes/Transition/position = Vector2(520, 120)
nodes/Walk/node = SubResource("30")
nodes/Walk/position = Vector2(200, 40)
nodes/output/position = Vector2(780, 160)
node_connections = [&"output", 0, &"Transition", &"Transition", 0, &"Walk", &"Transition", 1, &"Stop"]
script = ExtResource("13")
chain = false
schema = ""

[sub_resource type="AnimationNodeStateMachineTransition" id="32"]

[sub_resource type="AnimationNodeStateMachine" id="34"]
states/Investigate/node = SubResource("31")
states/Investigate/position = Vector2(791, 180)
states/Start/position = Vector2(344, 180)
transitions = ["Start", "Investigate", SubResource("32")]
graph_offset = Vector2(0, 75.2147)
script = ExtResource("4")
statemachine = ""
chain = false

[sub_resource type="AnimationNodeStateMachinePlayback" id="35"]

[sub_resource type="Animation" id="36"]
length = 0.001

[sub_resource type="AnimationLibrary" id="AnimationLibrary_0fhwy"]
_data = {
"DefaultAnim": SubResource("36")
}

[sub_resource type="AnimationNodeStateMachine" id="37"]
states/Face/node = SubResource("16")
states/Face/position = Vector2(779, 180.215)
states/Start/position = Vector2(344, 180)
transitions = ["Start", "Face", SubResource("17")]
graph_offset = Vector2(0, 75.2147)
script = ExtResource("4")
statemachine = ""
chain = false

[sub_resource type="AnimationNodeStateMachinePlayback" id="38"]

[sub_resource type="Animation" id="39"]
length = 0.001

[sub_resource type="AnimationLibrary" id="AnimationLibrary_o20eb"]
_data = {
"DefaultAnim": SubResource("39")
}

[sub_resource type="AnimationNodeStateMachine" id="40"]
states/Face/node = SubResource("16")
states/Face/position = Vector2(779, 180.215)
states/Start/position = Vector2(344, 180)
transitions = ["Start", "Face", SubResource("17")]
graph_offset = Vector2(0, 75.2147)
script = ExtResource("4")
statemachine = ""
chain = false

[sub_resource type="AnimationNodeStateMachinePlayback" id="41"]

[sub_resource type="Animation" id="42"]
length = 0.001

[sub_resource type="AnimationLibrary" id="AnimationLibrary_mos5q"]
_data = {
"DefaultAnim": SubResource("42")
}

[sub_resource type="AnimationNodeStateMachine" id="43"]
states/Face/node = SubResource("16")
states/Face/position = Vector2(779, 180.215)
states/Start/position = Vector2(344, 180)
transitions = ["Start", "Face", SubResource("17")]
graph_offset = Vector2(0, 75.2147)
script = ExtResource("4")
statemachine = ""
chain = false

[sub_resource type="AnimationNodeStateMachinePlayback" id="44"]

[sub_resource type="Animation" id="45"]
length = 0.001

[sub_resource type="AnimationLibrary" id="AnimationLibrary_k62d5"]
_data = {
"DefaultAnim": SubResource("45")
}

[sub_resource type="AnimationNodeStateMachine" id="46"]
states/Start/position = Vector2(105, 87)
graph_offset = Vector2(-298.364, -38.178)
script = ExtResource("4")
statemachine = ""
chain = false

[sub_resource type="AnimationNodeStateMachinePlayback" id="47"]

[sub_resource type="AnimationLibrary" id="AnimationLibrary_h2oll"]
_data = {
"DefaultAnim": ExtResource("6")
}

[sub_resource type="ViewportTexture" id="ViewportTexture_23qvt"]
viewport_path = NodePath("Viewport2D")

[sub_resource type="Animation" id="Animation_lgs6q"]
resource_name = "BulletTime"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Control/ColorCorrection:material:shader_param/brightness")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [1.1]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Control/ColorCorrection:material:shader_param/contrast")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [1.25]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Control/ColorCorrection:material:shader_param/saturation")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.75]
}

[sub_resource type="Animation" id="9"]
resource_name = "Default"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Control/ColorCorrection:material:shader_param/brightness")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [1.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Control/ColorCorrection:material:shader_param/contrast")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [1.0]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Control/ColorCorrection:material:shader_param/saturation")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [1.0]
}

[sub_resource type="Animation" id="Animation_4sjxp"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Control/ColorCorrection:material:shader_param/brightness")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [1.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Control/ColorCorrection:material:shader_param/contrast")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [1.0]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Control/ColorCorrection:material:shader_param/saturation")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [1.0]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_hdc2u"]
_data = {
"BulletTime": SubResource("Animation_lgs6q"),
"Default": SubResource("9"),
"RESET": SubResource("Animation_4sjxp")
}

[sub_resource type="AnimationNodeStateMachinePlayback" id="AnimationNodeStateMachinePlayback_nayog"]

[node name="AI" instance=ExtResource("1")]

[node name="Knowledge" type="Node" parent="." index="0"]

[node name="Vision" type="Node3D" parent="." index="1"]
script = ExtResource("2")

[node name="Hearing" type="Node3D" parent="." index="2"]
script = ExtResource("3")

[node name="PatrolGoal" type="AnimationTree" parent="." index="3"]
tree_root = SubResource("2")
anim_player = NodePath("AnimationPlayer")
parameters/playback = SubResource("3")
parameters/StateMachine/playback = SubResource("4")

[node name="AnimationPlayer" type="AnimationPlayer" parent="PatrolGoal" index="0"]
libraries = {
"": SubResource("AnimationLibrary_qmjdn")
}

[node name="InvestigateGoal" type="AnimationTree" parent="." index="4"]
tree_root = SubResource("10")
anim_player = NodePath("AnimationPlayer")
parameters/playback = SubResource("11")
script = ExtResource("9")
tree_node = NodePath("../AIPlanner")

[node name="AnimationPlayer" type="AnimationPlayer" parent="InvestigateGoal" index="0"]
libraries = {
"": SubResource("AnimationLibrary_6g7qn")
}

[node name="AIPlanner" type="AnimationTree" parent="." index="5"]
tree_root = SubResource("12")
anim_player = NodePath("AnimationPlayer")
parameters/playback = SubResource("13")
script = ExtResource("10")

[node name="AnimationPlayer" type="AnimationPlayer" parent="AIPlanner" index="0"]
libraries = {
"": SubResource("AnimationLibrary_qauup")
}

[node name="WaitCommand" type="AnimationTree" parent="." index="6"]
tree_root = SubResource("19")
anim_player = NodePath("AnimationPlayer")
parameters/playback = SubResource("20")
script = ExtResource("9")
tree_node = NodePath("../AIDriver")

[node name="AnimationPlayer" type="AnimationPlayer" parent="WaitCommand" index="0"]
libraries = {
"": SubResource("AnimationLibrary_ycdhx")
}

[node name="FaceCommand" type="AnimationTree" parent="." index="7"]
tree_root = SubResource("22")
anim_player = NodePath("AnimationPlayer")
parameters/playback = SubResource("23")
script = ExtResource("9")
tree_node = NodePath("../AIDriver")

[node name="AnimationPlayer" type="AnimationPlayer" parent="FaceCommand" index="0"]
libraries = {
"": SubResource("AnimationLibrary_nqidj")
}

[node name="FollowCommand" type="AnimationTree" parent="." index="8"]
tree_root = SubResource("25")
anim_player = NodePath("AnimationPlayer")
parameters/playback = SubResource("26")
script = ExtResource("9")
tree_node = NodePath("../AIDriver")

[node name="AnimationPlayer" type="AnimationPlayer" parent="FollowCommand" index="0"]
libraries = {
"": SubResource("AnimationLibrary_xewwj")
}

[node name="InvestigateCommand" type="AnimationTree" parent="." index="9"]
tree_root = SubResource("34")
anim_player = NodePath("AnimationPlayer")
parameters/playback = SubResource("35")
parameters/Investigate/Transition/current_state = ""
parameters/Investigate/Transition/transition_request = ""
parameters/Investigate/Transition/current_index = -1
script = ExtResource("9")
tree_node = NodePath("../AIDriver")

[node name="AnimationPlayer" type="AnimationPlayer" parent="InvestigateCommand" index="0"]
libraries = {
"": SubResource("AnimationLibrary_0fhwy")
}

[node name="ChaseCommand" type="AnimationTree" parent="." index="10"]
tree_root = SubResource("37")
anim_player = NodePath("AnimationPlayer")
parameters/playback = SubResource("38")
script = ExtResource("9")
tree_node = NodePath("../AIDriver")

[node name="AnimationPlayer" type="AnimationPlayer" parent="ChaseCommand" index="0"]
libraries = {
"": SubResource("AnimationLibrary_o20eb")
}

[node name="FleeCommand" type="AnimationTree" parent="." index="11"]
tree_root = SubResource("40")
anim_player = NodePath("AnimationPlayer")
parameters/playback = SubResource("41")
script = ExtResource("9")
tree_node = NodePath("../AIDriver")

[node name="AnimationPlayer" type="AnimationPlayer" parent="FleeCommand" index="0"]
libraries = {
"": SubResource("AnimationLibrary_mos5q")
}

[node name="AttackCommand" type="AnimationTree" parent="." index="12"]
tree_root = SubResource("43")
anim_player = NodePath("AnimationPlayer")
parameters/playback = SubResource("44")
script = ExtResource("9")
tree_node = NodePath("../AIDriver")

[node name="AnimationPlayer" type="AnimationPlayer" parent="AttackCommand" index="0"]
libraries = {
"": SubResource("AnimationLibrary_k62d5")
}

[node name="AIDriver" type="AnimationTree" parent="." index="13"]
tree_root = SubResource("46")
anim_player = NodePath("AnimationPlayer")
parameters/playback = SubResource("47")
script = ExtResource("14")

[node name="AnimationPlayer" type="AnimationPlayer" parent="AIDriver" index="0"]
libraries = {
"": SubResource("AnimationLibrary_h2oll")
}

[node name="CameraRig" parent="." index="20"]
viewport = NodePath("../../AI/Perspective/Container/SubViewport")

[node name="InventoryContainer" parent="." index="22"]
path = NodePath("../../AI")

[node name="CameraRaycastStim" parent="." index="37"]
path = NodePath("../../AI/CameraRig/Camera3D")

[node name="ColorCorrection" parent="Perspective/Control" index="0"]
texture = SubResource("ViewportTexture_23qvt")

[node name="AnimationPlayer" parent="Perspective" index="2"]
libraries = {
"": SubResource("AnimationLibrary_hdc2u")
}

[node name="AnimLayerMovement" parent="." index="42"]
parameters/playback = SubResource("AnimationNodeStateMachinePlayback_nayog")

[editable path="CameraRig"]
[editable path="Perspective"]
