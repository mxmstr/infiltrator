[gd_scene load_steps=11 format=3 uid="uid://cwd5p5o24jdll"]

[ext_resource type="Texture2D" uid="uid://d0ioun82qc3k6" path="res://Scenes/Actors/Particles/BarrelSmokeTexture.png" id="1"]
[ext_resource type="Script" path="res://Scripts/Actor.gd" id="2"]
[ext_resource type="PackedScene" path="res://Scenes/Components/Properties/Particles.property.tscn" id="3"]

[sub_resource type="Shader" id="1"]
code = "shader_type spatial;
render_mode cull_disabled;

uniform sampler2D smoke_texture;
uniform sampler2D noise_texture;
varying float lifetime_percent;

void vertex(){
	lifetime_percent = INSTANCE_CUSTOM.y;
}

void fragment(){
	float alpha = texture(smoke_texture, UV).r;
	float noise = texture(noise_texture, UV + vec2(0.0, lifetime_percent)).r;
	ALPHA = smoothstep(0.0, 1.0 - lifetime_percent, clamp(alpha * noise - pow(lifetime_percent, 2.0), 0.0,1.0) * COLOR.a);
	ALBEDO = COLOR.rgb;
}"

[sub_resource type="FastNoiseLite" id="2"]

[sub_resource type="NoiseTexture2D" id="3"]
width = 64
height = 64
seamless = true
noise = SubResource("2")

[sub_resource type="ShaderMaterial" id="4"]
render_priority = 0
shader = SubResource("1")
shader_parameter/smoke_texture = ExtResource("1")
shader_parameter/noise_texture = SubResource("3")

[sub_resource type="ParticleProcessMaterial" id="7"]
spread = 0.0
gravity = Vector3(0, 0.2, 0)

[sub_resource type="StandardMaterial3D" id="5"]
vertex_color_use_as_albedo = true

[sub_resource type="ArrayMesh" id="6"]
resource_name = "BarrelSmoke"
_surfaces = [{
"aabb": AABB(-0.147166, -0.0600011, -1.00445, 0.297137, 0.204578, 1.04055),
"attribute_data": PackedByteArray(0, 0, 0, 0, 0, 0, 0, 0, 0, 160, 119, 62, 0, 0, 0, 0, 0, 160, 119, 62, 0, 0, 0, 0, 0, 64, 250, 62, 0, 0, 0, 0, 0, 224, 125, 63, 0, 224, 123, 63, 0, 192, 61, 63, 0, 224, 123, 63, 0, 192, 61, 63, 0, 224, 123, 63, 0, 64, 250, 62, 0, 224, 123, 63, 0, 160, 119, 62, 0, 224, 123, 63, 0, 160, 119, 62, 0, 224, 123, 63, 0, 0, 0, 0, 0, 224, 123, 63, 0, 192, 61, 63, 0, 0, 0, 0, 0, 192, 61, 63, 0, 0, 0, 0, 0, 224, 125, 63, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 54, 63, 0, 0, 0, 0, 0, 96, 170, 62, 0, 0, 0, 0, 0, 96, 170, 62, 0, 64, 250, 62, 0, 96, 170, 62, 0, 64, 250, 62, 0, 64, 54, 63, 0, 224, 125, 63, 0, 96, 170, 62, 0, 224, 125, 63, 0, 96, 170, 62, 0, 224, 125, 63, 0, 64, 54, 63, 0, 192, 61, 63, 0, 64, 54, 63, 0, 192, 61, 63, 0, 64, 54, 63, 0, 192, 61, 63, 0, 96, 170, 62, 0, 160, 119, 62, 0, 64, 54, 63, 0, 160, 119, 62, 0, 64, 54, 63, 0, 160, 119, 62, 0, 96, 170, 62, 0, 160, 119, 62, 0, 96, 170, 62, 0, 96, 29, 63, 0, 0, 0, 0, 0, 0, 0, 0, 0, 224, 34, 62, 0, 160, 186, 62, 0, 0, 0, 0, 0, 224, 93, 63, 0, 224, 123, 63, 0, 96, 29, 63, 0, 224, 123, 63, 0, 160, 186, 62, 0, 224, 123, 63, 0, 64, 250, 62, 0, 32, 92, 63, 0, 224, 125, 63, 0, 32, 92, 63, 0, 192, 61, 63, 0, 224, 34, 62, 0, 192, 61, 63, 0, 224, 34, 62, 0, 224, 246, 61, 0, 224, 123, 63, 0, 224, 246, 61, 0, 0, 0, 0, 0, 160, 119, 62, 0, 224, 34, 62, 0, 160, 119, 62, 0, 224, 34, 62, 0, 224, 93, 63, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 92, 63, 0, 0, 0, 0, 0, 224, 6, 63, 0, 64, 250, 62, 0, 224, 34, 62, 0, 64, 250, 62, 0, 224, 6, 63, 0, 224, 125, 63, 0, 224, 34, 62, 0, 224, 125, 63, 0, 224, 6, 63, 0, 192, 61, 63, 0, 32, 92, 63, 0, 192, 61, 63, 0, 224, 6, 63, 0, 160, 119, 62, 0, 32, 92, 63, 0, 160, 119, 62, 0, 32, 92, 63, 0, 160, 119, 62, 0, 224, 6, 63, 0, 224, 246, 61, 0, 64, 54, 63, 0, 224, 246, 61, 0, 64, 54, 63, 0, 224, 246, 61, 0, 96, 170, 62, 0, 224, 246, 61, 0, 96, 170, 62, 0, 160, 186, 62, 0, 64, 54, 63, 0, 160, 186, 62, 0, 96, 170, 62, 0, 224, 93, 63, 0, 64, 54, 63, 0, 224, 93, 63, 0, 64, 54, 63, 0, 224, 93, 63, 0, 96, 170, 62, 0, 224, 93, 63, 0, 96, 170, 62, 0, 96, 29, 63, 0, 64, 54, 63, 0, 96, 29, 63, 0, 96, 170, 62, 0, 96, 29, 63, 0, 224, 34, 62, 0, 224, 93, 63, 0, 224, 34, 62, 0, 160, 186, 62, 0, 224, 34, 62, 0, 224, 246, 61, 0, 224, 34, 62, 0, 224, 246, 61, 0, 32, 92, 63, 0, 224, 246, 61, 0, 224, 6, 63, 0, 160, 186, 62, 0, 32, 92, 63, 0, 160, 186, 62, 0, 224, 6, 63, 0, 224, 93, 63, 0, 32, 92, 63, 0, 224, 93, 63, 0, 224, 6, 63, 0, 96, 29, 63, 0, 32, 92, 63, 0, 96, 29, 63, 0, 224, 6, 63),
"format": 4119,
"index_count": 288,
"index_data": PackedByteArray(24, 0, 67, 0, 66, 0, 24, 0, 38, 0, 67, 0, 66, 0, 46, 0, 17, 0, 66, 0, 67, 0, 46, 0, 67, 0, 3, 0, 46, 0, 67, 0, 29, 0, 3, 0, 38, 0, 29, 0, 67, 0, 38, 0, 12, 0, 29, 0, 19, 0, 68, 0, 64, 0, 19, 0, 48, 0, 68, 0, 64, 0, 37, 0, 24, 0, 64, 0, 68, 0, 37, 0, 68, 0, 11, 0, 37, 0, 68, 0, 43, 0, 11, 0, 48, 0, 43, 0, 68, 0, 48, 0, 13, 0, 43, 0, 17, 0, 69, 0, 60, 0, 17, 0, 46, 0, 69, 0, 60, 0, 41, 0, 27, 0, 60, 0, 69, 0, 41, 0, 69, 0, 2, 0, 41, 0, 69, 0, 31, 0, 2, 0, 46, 0, 31, 0, 69, 0, 46, 0, 3, 0, 31, 0, 28, 0, 70, 0, 57, 0, 28, 0, 42, 0, 70, 0, 57, 0, 30, 0, 15, 0, 57, 0, 70, 0, 30, 0, 70, 0, 0, 0, 30, 0, 70, 0, 40, 0, 0, 0, 42, 0, 40, 0, 70, 0, 42, 0, 1, 0, 40, 0, 8, 0, 71, 0, 39, 0, 8, 0, 53, 0, 71, 0, 39, 0, 44, 0, 10, 0, 39, 0, 71, 0, 44, 0, 71, 0, 14, 0, 44, 0, 71, 0, 55, 0, 14, 0, 53, 0, 55, 0, 71, 0, 53, 0, 26, 0, 55, 0, 25, 0, 72, 0, 56, 0, 25, 0, 54, 0, 72, 0, 56, 0, 45, 0, 14, 0, 56, 0, 72, 0, 45, 0, 72, 0, 16, 0, 45, 0, 72, 0, 58, 0, 16, 0, 54, 0, 58, 0, 72, 0, 54, 0, 27, 0, 58, 0, 7, 0, 73, 0, 34, 0, 7, 0, 35, 0, 73, 0, 34, 0, 52, 0, 9, 0, 34, 0, 73, 0, 52, 0, 73, 0, 25, 0, 52, 0, 73, 0, 59, 0, 25, 0, 35, 0, 59, 0, 73, 0, 35, 0, 18, 0, 59, 0, 18, 0, 74, 0, 59, 0, 18, 0, 47, 0, 74, 0, 59, 0, 54, 0, 25, 0, 59, 0, 74, 0, 54, 0, 74, 0, 27, 0, 54, 0, 74, 0, 60, 0, 27, 0, 47, 0, 60, 0, 74, 0, 47, 0, 17, 0, 60, 0, 4, 0, 75, 0, 32, 0, 4, 0, 36, 0, 75, 0, 32, 0, 50, 0, 5, 0, 32, 0, 75, 0, 50, 0, 75, 0, 23, 0, 50, 0, 75, 0, 62, 0, 23, 0, 36, 0, 62, 0, 75, 0, 36, 0, 21, 0, 62, 0, 21, 0, 76, 0, 61, 0, 21, 0, 49, 0, 76, 0, 61, 0, 51, 0, 22, 0, 61, 0, 76, 0, 51, 0, 76, 0, 24, 0, 51, 0, 76, 0, 63, 0, 24, 0, 49, 0, 63, 0, 76, 0, 49, 0, 20, 0, 63, 0, 6, 0, 77, 0, 33, 0, 6, 0, 50, 0, 77, 0, 33, 0, 35, 0, 7, 0, 33, 0, 77, 0, 35, 0, 77, 0, 18, 0, 35, 0, 77, 0, 65, 0, 18, 0, 50, 0, 65, 0, 77, 0, 50, 0, 22, 0, 65, 0, 22, 0, 78, 0, 65, 0, 22, 0, 51, 0, 78, 0, 65, 0, 47, 0, 18, 0, 65, 0, 78, 0, 47, 0, 78, 0, 17, 0, 47, 0, 78, 0, 66, 0, 17, 0, 51, 0, 66, 0, 78, 0, 51, 0, 24, 0, 66, 0),
"material": SubResource("5"),
"primitive": 3,
"vertex_count": 79,
"vertex_data": PackedByteArray(21, 209, 243, 189, 194, 115, 43, 61, 230, 209, 112, 191, 24, 38, 60, 127, 101, 0, 0, 0, 241, 58, 244, 189, 92, 161, 200, 60, 193, 99, 128, 191, 36, 234, 245, 103, 111, 0, 0, 0, 241, 58, 244, 189, 92, 161, 200, 60, 193, 99, 128, 191, 90, 248, 156, 61, 115, 0, 0, 0, 45, 136, 201, 189, 49, 20, 2, 61, 250, 145, 128, 191, 146, 193, 86, 81, 101, 0, 0, 0, 59, 26, 161, 61, 154, 67, 15, 61, 215, 227, 60, 188, 88, 212, 1, 110, 46, 0, 0, 0, 159, 54, 1, 61, 100, 208, 157, 61, 224, 152, 10, 61, 240, 208, 225, 97, 49, 0, 0, 0, 159, 54, 1, 61, 100, 208, 157, 61, 224, 152, 10, 61, 123, 203, 125, 96, 32, 0, 0, 0, 24, 52, 160, 187, 208, 84, 175, 61, 155, 84, 19, 61, 255, 255, 23, 61, 32, 0, 0, 0, 120, 39, 17, 189, 240, 206, 139, 61, 155, 23, 17, 61, 40, 189, 90, 40, 114, 0, 0, 0, 120, 39, 17, 189, 240, 206, 139, 61, 155, 23, 17, 61, 207, 194, 208, 34, 40, 0, 0, 0, 161, 221, 142, 189, 78, 228, 14, 61, 20, 92, 73, 188, 133, 166, 163, 50, 97, 0, 0, 0, 15, 175, 160, 189, 39, 13, 187, 60, 113, 32, 128, 191, 66, 150, 15, 93, 103, 0, 0, 0, 15, 175, 160, 189, 39, 13, 187, 60, 113, 32, 128, 191, 97, 151, 176, 91, 100, 0, 0, 0, 250, 243, 107, 189, 19, 190, 139, 187, 48, 62, 112, 191, 90, 145, 238, 75, 105, 0, 0, 0, 150, 178, 22, 190, 120, 253, 31, 61, 44, 98, 135, 190, 178, 185, 210, 33, 97, 0, 0, 0, 157, 105, 198, 189, 94, 123, 13, 62, 56, 216, 34, 191, 92, 233, 155, 47, 39, 0, 0, 0, 157, 105, 198, 189, 94, 123, 13, 62, 56, 216, 34, 191, 57, 233, 75, 48, 47, 0, 0, 0, 228, 176, 121, 61, 221, 223, 195, 61, 145, 178, 38, 191, 13, 186, 17, 101, 110, 0, 0, 0, 66, 54, 42, 61, 185, 183, 5, 62, 15, 22, 121, 190, 248, 225, 50, 80, 99, 0, 0, 0, 80, 51, 212, 60, 137, 253, 84, 189, 74, 175, 34, 191, 112, 84, 132, 99, 47, 0, 0, 0, 80, 51, 212, 60, 137, 253, 84, 189, 74, 175, 34, 191, 76, 83, 228, 99, 105, 0, 0, 0, 0, 146, 25, 62, 113, 46, 59, 189, 212, 120, 132, 190, 135, 136, 173, 124, 47, 0, 0, 0, 6, 93, 0, 62, 169, 14, 134, 61, 53, 152, 129, 190, 21, 176, 50, 108, 101, 0, 0, 0, 6, 93, 0, 62, 169, 14, 134, 61, 53, 152, 129, 190, 71, 174, 191, 107, 110, 0, 0, 0, 206, 102, 146, 61, 56, 234, 166, 60, 199, 5, 38, 191, 168, 110, 50, 115, 41, 0, 0, 0, 161, 140, 133, 189, 202, 67, 241, 61, 51, 215, 127, 190, 90, 208, 204, 44, 115, 0, 0, 0, 161, 140, 133, 189, 202, 67, 241, 61, 51, 215, 127, 190, 232, 207, 141, 44, 111, 0, 0, 0, 126, 142, 210, 187, 227, 192, 17, 62, 93, 67, 37, 191, 104, 240, 32, 77, 101, 0, 0, 0, 126, 142, 210, 187, 227, 192, 17, 62, 93, 67, 37, 191, 78, 240, 204, 76, 97, 0, 0, 0, 156, 49, 179, 189, 91, 255, 238, 60, 234, 106, 128, 191, 14, 171, 46, 88, 112, 0, 0, 0, 183, 194, 205, 189, 77, 216, 208, 61, 31, 5, 80, 191, 178, 253, 214, 44, 101, 0, 0, 0, 146, 91, 224, 189, 249, 93, 246, 60, 235, 142, 128, 191, 242, 220, 255, 71, 110, 0, 0, 0, 41, 194, 69, 61, 92, 141, 127, 61, 82, 125, 223, 60, 13, 201, 168, 105, 46, 0, 0, 0, 219, 152, 101, 60, 202, 63, 173, 61, 43, 150, 15, 61, 21, 223, 216, 84, 115, 0, 0, 0, 231, 69, 182, 188, 128, 101, 163, 61, 222, 212, 19, 61, 80, 219, 168, 45, 32, 0, 0, 0, 254, 185, 135, 60, 153, 68, 236, 61, 149, 25, 183, 189, 118, 243, 155, 71, 97, 0, 0, 0, 8, 233, 3, 62, 81, 94, 251, 187, 252, 4, 225, 189, 184, 167, 193, 114, 32, 0, 0, 0, 44, 41, 31, 59, 80, 46, 131, 60, 125, 238, 84, 191, 38, 109, 74, 112, 32, 0, 0, 0, 44, 41, 31, 59, 80, 46, 131, 60, 125, 238, 84, 191, 8, 111, 107, 111, 117, 0, 0, 0, 162, 126, 59, 189, 97, 178, 87, 61, 16, 241, 232, 60, 238, 174, 146, 36, 40, 0, 0, 0, 181, 115, 255, 189, 16, 35, 167, 60, 180, 82, 126, 191, 222, 242, 189, 101, 99, 0, 0, 0, 172, 7, 50, 189, 9, 182, 198, 61, 240, 180, 84, 191, 19, 239, 126, 83, 119, 0, 0, 0, 172, 7, 50, 189, 9, 182, 198, 61, 240, 180, 84, 191, 110, 239, 17, 82, 32, 0, 0, 0, 157, 120, 145, 189, 104, 238, 79, 60, 44, 166, 125, 191, 198, 138, 147, 87, 97, 0, 0, 0, 227, 229, 239, 189, 70, 226, 177, 60, 186, 81, 233, 189, 159, 173, 162, 32, 105, 0, 0, 0, 67, 245, 1, 190, 10, 127, 202, 61, 92, 12, 228, 190, 25, 206, 127, 40, 110, 0, 0, 0, 224, 108, 199, 186, 242, 74, 132, 61, 21, 36, 86, 191, 10, 185, 66, 102, 101, 0, 0, 0, 132, 150, 136, 61, 21, 96, 248, 61, 231, 31, 226, 190, 204, 204, 5, 91, 114, 0, 0, 0, 106, 164, 230, 188, 246, 232, 240, 188, 175, 209, 79, 191, 44, 89, 107, 93, 116, 0, 0, 0, 21, 186, 208, 61, 184, 195, 117, 189, 249, 75, 226, 190, 255, 103, 50, 113, 110, 0, 0, 0, 3, 254, 185, 61, 20, 58, 155, 61, 222, 32, 200, 189, 81, 193, 155, 101, 101, 0, 0, 0, 45, 1, 239, 61, 165, 119, 43, 61, 221, 77, 228, 190, 167, 145, 156, 119, 107, 0, 0, 0, 99, 252, 129, 189, 68, 94, 188, 61, 149, 253, 194, 189, 169, 194, 255, 38, 105, 0, 0, 0, 99, 252, 129, 189, 68, 94, 188, 61, 149, 253, 194, 189, 169, 194, 170, 38, 116, 0, 0, 0, 135, 99, 242, 188, 85, 12, 18, 62, 59, 115, 226, 190, 149, 237, 27, 56, 118, 0, 0, 0, 43, 6, 223, 189, 206, 142, 170, 61, 87, 123, 131, 190, 169, 190, 85, 36, 111, 0, 0, 0, 43, 6, 223, 189, 206, 142, 170, 61, 87, 123, 131, 190, 253, 190, 48, 36, 0, 0, 0, 0, 179, 199, 78, 189, 214, 11, 20, 62, 50, 29, 36, 191, 176, 243, 72, 51, 0, 0, 0, 0, 179, 199, 78, 189, 214, 11, 20, 62, 50, 29, 36, 191, 93, 243, 161, 52, 152, 69, 94, 43, 51, 245, 84, 188, 68, 157, 9, 62, 100, 107, 122, 190, 199, 240, 134, 59, 0, 0, 0, 0, 150, 190, 4, 61, 185, 23, 0, 62, 58, 43, 38, 191, 176, 211, 171, 89, 0, 0, 0, 0, 18, 65, 18, 62, 212, 170, 82, 60, 56, 115, 131, 190, 9, 150, 24, 119, 0, 0, 0, 0, 18, 65, 18, 62, 212, 170, 82, 60, 56, 115, 131, 190, 147, 151, 39, 119, 0, 0, 0, 0, 35, 238, 88, 61, 30, 100, 135, 188, 59, 146, 36, 191, 212, 88, 42, 103, 0, 0, 0, 0, 35, 238, 88, 61, 30, 100, 135, 188, 59, 146, 36, 191, 10, 89, 244, 102, 0, 0, 0, 0, 20, 165, 184, 61, 15, 204, 217, 61, 123, 68, 125, 190, 118, 200, 125, 95, 0, 0, 0, 0, 254, 126, 152, 61, 248, 242, 113, 61, 183, 180, 38, 191, 107, 152, 201, 115, 0, 0, 0, 0, 72, 114, 190, 59, 50, 137, 38, 61, 191, 223, 85, 191, 75, 150, 50, 115, 0, 0, 0, 0, 219, 200, 45, 188, 214, 28, 230, 187, 72, 33, 83, 191, 86, 92, 17, 98, 0, 0, 0, 0, 236, 19, 155, 188, 243, 43, 173, 61, 130, 178, 85, 191, 111, 212, 37, 92, 0, 0, 0, 0, 34, 169, 146, 189, 15, 72, 206, 61, 201, 16, 83, 191, 255, 255, 77, 47, 0, 0, 0, 0, 214, 196, 188, 189, 143, 99, 118, 61, 200, 149, 209, 189, 134, 177, 205, 32, 0, 0, 0, 0, 52, 177, 161, 189, 188, 231, 0, 62, 110, 55, 227, 190, 24, 215, 175, 44, 0, 0, 0, 0, 149, 93, 212, 188, 230, 2, 228, 61, 11, 144, 185, 189, 3, 223, 166, 50, 0, 0, 0, 0, 155, 104, 172, 60, 45, 88, 16, 62, 129, 232, 225, 190, 244, 232, 132, 75, 0, 0, 0, 0, 246, 91, 230, 61, 226, 140, 25, 61, 43, 212, 209, 189, 177, 176, 66, 110, 0, 0, 0, 0, 148, 171, 234, 61, 213, 253, 1, 188, 148, 199, 227, 190, 24, 113, 202, 118, 0, 0, 0, 0, 120, 252, 107, 61, 211, 140, 210, 61, 42, 215, 189, 189, 204, 213, 81, 89, 0, 0, 0, 0, 160, 36, 205, 61, 155, 81, 177, 61, 216, 88, 227, 190, 13, 179, 68, 104, 0, 0, 0, 0)
}]

[node name="Smoke" type="Node3D"]
transform = Transform3D(0.5, 6.93889e-18, -3.03309e-25, 0, -2.18557e-08, -0.5, -6.93889e-18, 0.5, -2.18557e-08, 0, 0, 0)
script = ExtResource("2")
tags = "Particles"

[node name="Particles" parent="." instance=ExtResource("3")]
transform = Transform3D(0.5, 6.93889e-18, -3.03309e-25, 0, -2.18557e-08, -0.5, -6.93889e-18, 0.5, -2.18557e-08, 0, 0, 0)
material_override = SubResource("4")
cast_shadow = 0
emitting = false
amount = 3
lifetime = 1.5
one_shot = true
explosiveness = 0.52
process_material = SubResource("7")
draw_pass_1 = SubResource("6")
